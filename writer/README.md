# SpeedFogWriter

C# component of SpeedFog that generates Elden Ring mod files from `graph.json`.

## Requirements

- .NET 8.0 SDK
- Elden Ring game files (regulation.bin, MSBs, EMEVDs)
- Data files from `../data/` (fog_data.json, clusters.json, etc.)

## Building

```bash
cd writer
dotnet build
```

## Usage

```bash
dotnet run --project SpeedFogWriter -- <graph.json> <game_dir> <output_dir> [options]
```

### Arguments

- `graph.json` - Path to graph generated by speedfog-core (Phase 2)
- `game_dir` - Path to Elden Ring's Game folder (contains regulation.bin)
- `output_dir` - Where to write mod files

### Options

- `--data-dir <path>` - Custom path to data directory (default: ../data)
- `--no-package` - Skip ModEngine packaging (output mod files only)
- `--update-modengine` - Force re-download of ModEngine 2
- `--no-spoiler` - Skip spoiler.txt generation

## Output

Creates a self-contained mod with ModEngine 2 and launcher scripts:

```
output/
├── ModEngine/              # ModEngine 2 (auto-downloaded)
├── mods/speedfog/          # Mod files
│   ├── param/gameparam/regulation.bin
│   ├── event/*.emevd.dcx
│   └── map/mapstudio/*.msb.dcx
├── config_speedfog.toml    # ModEngine config
├── launch_speedfog.bat     # Windows launcher
├── launch_speedfog.sh      # Linux/Proton launcher
└── spoiler.txt             # Path spoiler log
```

## Playing

After generating the mod:
- **Windows**: Double-click `output/launch_speedfog.bat`
- **Linux/Proton**: Run `output/launch_speedfog.sh`

## Development

See `docs/plans/phase-3-csharp-writer.md` for detailed implementation spec.

### Running Tests

```bash
cd writer/test
./run_integration.sh
```
